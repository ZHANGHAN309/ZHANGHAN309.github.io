---
title: 重要功能
date: 2025/11/11
layout: draft
tags: C#
categories: 技术篇
---

# 布尔条件



# 自动垃圾回收



# 标准库



# 组件版本



# 属性和事件



# 委托和事件管理



# 易于使用的泛型



# 索引器



# 条件编译



# 简单的多线程



# LINQ和Lambda表达式

## Lambda表达式
Lambda表达式是一个简洁的语法，用于创建匿名函数，常用于LINQ查询和委托
语法格式为(参数)=>表达式/代码块

1. 无参数Lambda
```C#
// 1. 定义一个无参数委托（或使用系统内置委托 Action）
Action showMessage = () => MessageBox.Show("Hello Lambda!");

// 2. 调用（比如按钮点击事件绑定）
button1.Click += (s, e) => showMessage(); // 等价于：点击按钮时弹出弹窗
```
2. 单参数Lambda
```C#
// 场景：给数字加 10
Func<int, int> addTen = x => x + 10; // Func<输入类型, 输出类型>：有返回值的委托

// 调用
int result = addTen(5); // 结果：15
Console.WriteLine(result);
```
3. 多参数Lambda
```C#
// 场景：计算两个数的和（带复杂逻辑，用大括号和 return）
Func<int, int, int> calculateSum = (a, b) => 
{
    int sum = a + b;
    Console.WriteLine($"a + b = {sum}");
    return sum; // 复杂逻辑需显式 return
};

// 调用
int total = calculateSum(3, 7); // 结果：10，控制台输出 "a + b = 10"
```
4. LINQ中的Lambda
```C#
// 准备一个学生集合
List<Student> students = new List<Student>
{
    new Student { Name = "张三", Age = 18, Score = 90 },
    new Student { Name = "李四", Age = 20, Score = 85 },
    new Student { Name = "王五", Age = 19, Score = 95 }
};

// 1. 筛选：查询分数 >= 90 的学生（Where + Lambda）
var topStudents = students.Where(s => s.Score >= 90); 
// 结果：张三、王五

// 2. 排序：按年龄升序排列（OrderBy + Lambda）
var sortedStudents = students.OrderBy(s => s.Age); 
// 结果：张三（18）→ 王五（19）→ 李四（20）

// 3. 转换：提取所有学生姓名（Select + Lambda）
var names = students.Select(s => s.Name); 
// 结果：["张三", "李四", "王五"]

// 辅助类：Student
public class Student
{
    public string Name { get; set; }
    public int Age { get; set; }
    public int Score { get; set; }
}
```
5. 事件注册的Lambda
```C#
// 场景：WPF 图表的鼠标移动事件（替代单独写 Chart_MouseMove 方法）
myChart.MouseMove += (sender, e) => 
{
    // 鼠标移动时的逻辑：比如显示当前坐标
    var chart = sender as Chart;
    if (chart != null)
    {
        Console.WriteLine($"鼠标位置：X={e.X}, Y={e.Y}");
    }
};

// 对应你之前的全局异常捕获（Lambda 简化事件注册）
AppDomain.CurrentDomain.UnhandledException += (sender, targs) =>
{
    var ex = targs.ExceptionObject as Exception;
    if (ex != null)
    {
        MessageBox.Show($"异常：{ex.Message}");
    }
};
```
## 匿名方法delegate
delegate是C# 2.0引入的特性，Lambda是C# 3.0引入的特性，相比之下Lambda更简单更灵活
匿名方法语法：`delegate(参数){代码块}`
```C#
using System;

delegate void NumberChanger(int n);
namespace DelegateAppl
{
    class TestDelegate
    {
        static int num = 10;
        public static void AddNum(int p)
        {
            num += p;
            Console.WriteLine("Named Method: {0}", num);
        }

        public static void MultNum(int q)
        {
            num *= q;
            Console.WriteLine("Named Method: {0}", num);
        }

        static void Main(string[] args)
        {
            // 使用匿名方法创建委托实例
            NumberChanger nc = delegate(int x)
            {
               Console.WriteLine("Anonymous Method: {0}", x);
            };
            
            // 使用匿名方法调用委托
            nc(10);

            // 使用命名方法实例化委托
            nc =  new NumberChanger(AddNum);
            
            // 使用命名方法调用委托
            nc(5);

            // 使用另一个命名方法实例化委托
            nc =  new NumberChanger(MultNum);
            
            // 使用命名方法调用委托
            nc(2);
            Console.ReadKey();
        }
    }
}
```
## LINQ语言集成查询
LINQ是在C# 3.0引入的，简单来说就是用简单统一的语法，查询和操作各种数据源
在 LINQ 出现前，操作不同数据源的方式完全不同：
操作集合（如 List）：用 for/foreach 循环遍历筛选；
操作数据库：写 SQL 语句；
操作 XML：用 XmlDocument 等 API 遍历节点。
LINQ 解决了这个问题：用 一套语法 搞定所有数据源，比如：
```C#
// 1. 查询集合（List<Student>）
var highScoreStudents = students.Where(s => s.Score > 90);

// 2. 查询数据库（Entity Framework 配合 LINQ to SQL）
var dbUsers = dbContext.Users.Where(u => u.Age > 18);

// 3. 查询 XML（LINQ to XML）
var xmlElements = xDoc.Descendants("Book").Where(b => b.Attribute("Price").Value > "50");
```

常用操作方法

|操作符|作用|示例|
|---|---|---|
|Where	|按条件筛选元素|	students.Where(s => s.Age < 20)|
|OrderBy|	按指定字段升序排序	|students.OrderBy(s => s.Score)|
|OrderByDescending	|按指定字段降序排序	|students.OrderByDescending(s => s.Score)|
|Select	|转换元素（提取字段或修改格式）	|students.Select(s => new { s.Name, s.Score })（匿名对象）|
|FirstOrDefault|	获取第一个元素，无则返回默认值|	students.FirstOrDefault(s => s.Name == "张三")|
|Count	|统计符合条件的元素个数|	students.Count(s => s.Score >= 85)|
|GroupBy	|按指定字段分组|	students.GroupBy(s => s.Score >= 90)（分为 “高分” 和 “非高分” 两组）|
|Join	|多集合 / 表连接（类似 SQL 的 JOIN）|	students.Join(classes, s => s.ClassId, c => c.Id, (s, c) => new { s.Name, c.ClassName })|

# 集成Windows